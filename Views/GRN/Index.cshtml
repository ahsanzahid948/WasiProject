@model IEnumerable<InventoryManagementSystem.Models.GRN>
@{ int count = 1;
}
    @{
        ViewBag.Title = "Index";
        var UserPics = "";
    }


    @section styles
    {

        <style>
        </style>

    }
    <head>

        <link href="~/Content/CSS/color_file.css" rel="stylesheet" />

    </head>


    <div class="page-header page-header-light">

        <div class="breadcrumb-line breadcrumb-line-light header-elements-md-inline" style="margin-top:15px;">
            <div class="d-flex">
                <div class="breadcrumb">
                    <a href="~/UserManagement/Dashboard/Index" class="breadcrumb-item"><i class="icon-home2 mr-2"></i> Home</a>
                    <span style="background-color:red !important;">User</span>
                </div>

                <a href="#" class="header-elements-toggle text-default d-md-none"><i class="icon-more"></i></a>
            </div>
        </div>



    </div>

    <div class="card" style=" margin-top:15px">
        <div class="card-header header-elements-inline bg-orange-800">

            <h5 class="card-title">

                <a href="/GRN/New" type='button' class='btn   btn-labeled btn-labeled-left btn-sm authorizeOrNotInsert' style="background-color: #f5e486; color: black;">
                    <b><i class="icon-plus3"></i></b>
                    NEW
                </a>
                <span class="font-weight-semibold  usercolor" style=""> GRN</span>
            </h5>

            <div class="header-elements">
                <div class="list-icons">
                    <a class="list-icons-item" data-action="collapse"></a>
                    <a class="list-icons-item" data-action="reload"></a>

                </div>
            </div>
        </div>

        <div class="card-body">
            <table class="table datatable-button-html5-columns dataTable no-footer responsive" id="tblGRN">
                <thead>
                    <tr>
                        <th>Sr.</th>

                        <th>GRNNo</th>

                        <th>Name</th>
                        <th>Lab</th>
                        <th>Project</th>
                        <th>SuplyOrderNo</th>
                        <th>SuplyDate</th>
                        <th>GRNDate</th>
                        <th>Action</th>
                        @foreach (var m in Model)
                        {
                    <tr>
                        <td>@count</td>

                        <td>@m.GRNNo</td>
                        <td>@m.Name</td>
                        <td>@m.Lab</td>
                        <th>@m.Project</th>

                        <td>@m.SuplyOrderNo</td>
                        <th>@m.SuplyDate</th>

                        <td>@m.GRNDate</td>
                        <td><button type='button' onclick="window.location.href = '/GRN/View?ID=@m.ID';" class='btn bg-primary  btn-sm authorizeOrNotUpdate' style='color:white'>View </button><button type='button' onclick="window.location.href = '/GRN/GetUpdate?ID=@m.ID';" class='btn bg-blue  btn-sm authorizeOrNotUpdate' style='color:white;margin-left:10px'>Update </button><button onclick='Delete(@m.ID);' type='button' class='btn bg-danger btn-sm authorizeOrNotDelete' style='color:white;margin-left:10px'>Delete</button></td>
                       
                    </tr>
                        count++;
                    }
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>


        </div>

        <div id="SaveModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form id="UserForm" class="form-horizontal">
                        @Html.AntiForgeryToken()
                        <div class="modal-header">
                            <h4 class="modal-title"><i class="icon-pencil"></i> <span id="modalHeading" class="caption-subject font-green bold uppercase">User </span></h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>

                        </div>
                        <div class="modal-body">
                            <div class="form-body">

                                <div class="form-group row">
                                    <label class="control-label col-md-3">
                                        First Name
                                        <span class="text-danger"> * </span>
                                    </label>
                                    <div class="col-md-7">
                                        <input type="text" id="txtID" class="form-control" name="ID" style="display:none" />

                                        <input id="TxtFirstName" type="text" class="form-control" name="FirstName" maxlength="50" required />

                                    </div>
                                </div>
                                <div class="form-group  row">
                                    <label class="control-label col-md-3">
                                        Last Name
                                        <span class="text-danger"> * </span>
                                    </label>
                                    <div class="col-md-7">

                                        <input id="TxtLastName" type="text" class="form-control" name="LastName" maxlength="50" required />

                                    </div>
                                </div>

                                <div class="form-group  row">
                                    <label class="control-label col-md-3">
                                        Email
                                        <span class="text-danger"> * </span>
                                    </label>
                                    <div class="col-md-7">

                                        <input type="text" id="TxtEmailAddress" class="form-control" name="EmailAddress" value="" maxlength="50" required />

                                    </div>
                                </div>
                                <div class="form-group  row">
                                    <label class="control-label col-md-3">
                                        Mobile Number
                                        <span class="text-danger"> * </span>
                                    </label>
                                    <div class="col-md-7">

                                        <input id="TxtMobileNumber" type="text" class="form-control" name="MobileNumber" maxlength="50" required />

                                    </div>
                                </div>

                                <div>

                                </div>
                                <div class="form-group  row">
                                    <label class="control-label col-md-3">
                                        Password
                                        <span class="text-danger"> * </span>
                                    </label>
                                    <div class="col-md-6">


                                        <input type="password" id="TxtPassword" name="Password" maxlength="20" class="form-control" onkeyup="CheckPasswordStrength(this.value)" required />
                                    </div>
                                    <div class="col-md-1">

                                        <span><strong id="password_strength"></strong></span>

                                    </div>

                                </div>






                                <div class="form-group row">
                                    <label class="control-label col-md-3">
                                        Profile Photo
                                    </label>
                                    <div class="col-md-7">

                                        <input type="file" id="fileUserProfileImage" name="fileUserProfileImage" accept='image/*' onchange="fnChangeUserPic(this);" />
                                        <input type="hidden" id="UserProfileImage" name="UserProfileImage" value="~/Content/DumyProfile.png" maxlength="100" />

                                    </div>

                                    <input type="hidden" id="UserProfileImage" name="UserProfileImage" value="~/Content/DumyProfile.png" maxlength="100" />

                                </div>
                            </div>


                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn bg-danger btn-labeled btn-labeled-left btn-sm" data-dismiss="modal" style="color:white"><b><i class="icon-cross2"></i></b>Close</button>
                            <button type="submit" id="btnsave" class="btn btn-primary btn-sm">Save changes<b><i class="icon-paperplane ml-2"></i></b></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

      
            <script>

                $(document).ready(function () {





                });


                function LoadTableData() {

                    $("body").tooltip({ selector: '[data-toggle=tooltip]' });
                    $('[data-toggle="tooltip"]').tooltip({ html: true });

                    var table = $("#tblGRN").DataTable();
                    var count = 1;
                    var headers = {};
                    var token = $('input[name="__RequestVerificationToken"]').val();
                    headers['__RequestVerificationToken'] = token;

                    $.ajax(
                        {
                            type: "POST",
                            headers: headers,
                            contentType: "application/json; charset=utf-8",
                            url: "/GRN/GetList",
                            data: JSON.stringify({ ID: 0 }),
                            dataType: "json",
                            success: function (result) {

                                if (result != null && result != "Error") {

                                    table.clear();
                                    $.each(result, function (i, Data) {
                                        var Active = Data.IsActive == "true" || Data.IsActive == "True" || Data.IsActive == "1" ? "Yes" : "No";
                                        var newRow = "<tr><td hidden>" + Data.ID + "</td>" +
                                            "<td  style='text-align:left'>" + count++ + "</td>" +
                                            "<td>" + Data.GRNNo + " </td>" +
                                            "<td>" + Data.Lab + "</td>" +
                                            "<td>" + Data.Project + "</td>" +
                                            "<td>" + Data.SuplyOrderNo + "</td>" +

                                            "<td>" + Date(Data.SuplyDate) + "</td>" +
                                            "<td>" + Date(Data.SuplyDate) + "</td>" +


                                            "<td style='text-align:Right'>" +
                                            " <div class='list-icons'><div class='dropdown hide'><a href='#' class='btn btn-sm' style='background-color: #f5e486' data-toggle='dropdown' aria-expanded='true'>" +
                                            "<i class='icon-menu9'></i></a>" +
                                            "<div class='dropdown-menu dropdown-menu-right hide' x-placement='top-end' style='text-align:center;position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(-158px, -127px, 0px);min-width: 6.50rem;padding:0.2rem 0!important;'>" +
                                            "<span class='red-tooltip' data-toggle='tooltip' title='Edit'><button onclick='ModifyRecord(" + Data.ID + ");'type='button' class='btn bg-primary-600  btn-sm authorizeOrNotUpdate'  style='color:white'><b><i class='icon-pencil'></i></b></button></span>" +
                                            "<span class='red-tooltip' data-toggle='tooltip' title='Delete'><button onclick='Delete(" + Data.ID + ");'type='button' class='btn bg-danger btn-sm authorizeOrNotDelete'  style='color:white'><b><i class='icon-bin'></i></b></button></span>" +
                                            "</div ></div ></div></td></tr>";

                                        table.row.add($(newRow));
                                    });
                                    table.draw();
                                }
                                else {
                                    var errorMessage = AjaxErrorMessage + ' (Error Code: "400")';
                                    swal("", errorMessage, "error");
                                }

                            },
                            error: function (xhr, status, error) {
                                var errorMessage = AjaxErrorMessage + ' (Error Code: ' + xhr.status + ')';
                                swal("", errorMessage, "error");

                            }

                        });
                }

                function Delete(ID) {
                    var headers = {};
                    var token = $('input[name="__RequestVerificationToken"]').val();
                    headers['__RequestVerificationToken'] = token;
                    $.ajax(
                        {
                            type: "POST",
                            headers: headers,
                            contentType: "application/json; charset=utf-8",
                            url: "/GRN/Delete",
                            data: JSON.stringify({ ID: ID }),
                            dataType: "json",
                            success: function (result) {
                                swal("GRN Deleted Successfully");
                                window.location.replace("/GRN/Index");
                            },
                            error: function (xhr, status, error) {

                                swal("GRN Deleted Successfully ");
                                window.location.replace("/GRN/Index");
                            }

                        });


                }


                function View(ID) {
                    alert(ID);
                    var headers = {};
                    var token = $('input[name="__RequestVerificationToken"]').val();
                    headers['__RequestVerificationToken'] = token;
                    $.ajax(
                        {
                            type: "POST",
                            headers: headers,
                            contentType: "application/json; charset=utf-8",
                            url: "/View",
                            data: JSON.stringify({ ID: ID }),
                            dataType: "json",
                            success: function (result) {
                                if (result != null) { debugger }
                            },
                            error: function (xhr, status, error) {

                              
                            }

                        });


                }
                
            </script>

    



